<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ETM Simulator (Clickable Prototype)</title>
  <style>
    :root{
      --navy:#062b3a;
      --navy2:#053044;
      --bg:#f3f6fb;
      --card:#ffffff;
      --text:#1f2a37;
      --muted:#6b7280;
      --line:#e6eaf2;
      --blue:#1f6fff;
      --blue2:#0f5fe8;
      --chip:#eef3ff;
      --chipLine:#d7e3ff;
      --success:#20b46a;
      --shadow: 0 10px 28px rgba(18, 38, 63, .12);
      --shadow2: 0 25px 70px rgba(0,0,0,.22);
      --r:14px;
      --r2:18px;
      --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:var(--font);color:var(--text);background:var(--bg)}
    a{color:inherit;text-decoration:none}
    button,input,select,textarea{font-family:inherit}

    /* Top nav */
    .top{position:sticky;top:0;z-index:50;background:#fff;border-bottom:1px solid var(--line)}
    .topInner{max-width:1200px;margin:0 auto;padding:14px 18px;display:flex;align-items:center;justify-content:space-between;gap:14px}
    .brand{display:flex;align-items:center;gap:12px;font-weight:900}
    .brandText{font-size:24px;letter-spacing:-.5px;font-weight:1000;color:#0b2a3a}
    .navLinks{display:flex;gap:16px;align-items:center;color:var(--muted);font-weight:800;font-size:14px}
    .navLinks a.active{color:var(--text)}
    .rightControls{display:flex;align-items:center;gap:10px}
    .pill{border:1px solid var(--line);background:#fff;border-radius:12px;padding:8px 10px;display:flex;gap:8px;align-items:center;font-size:13px;color:var(--muted)}
    .avatar{width:34px;height:34px;border-radius:999px;display:grid;place-items:center;background:#eef2ff;border:1px solid var(--line);font-weight:900;color:#334155}
    .iconBtn{width:36px;height:36px;border-radius:12px;border:1px solid var(--line);background:#fff;cursor:pointer}

    /* Layout */
    .wrap{max-width:1200px;margin:0 auto;padding:18px}

    /* Hero */
    .hero{background:linear-gradient(180deg,var(--navy),var(--navy2));padding:34px 0 24px}
    .heroInner{max-width:1200px;margin:0 auto;padding:0 18px;display:flex;flex-direction:column;align-items:center;text-align:center;color:#fff;gap:12px}
    .heroTitle{font-size:44px;line-height:1.05;margin:10px 0 0;font-weight:900;letter-spacing:-.6px}
    .heroTitle .accent{color:#7bd3ff}

    /* Search bar (compact, equal heights) */
    .searchBar{
      width:min(1060px, 98%);
      background:#fff;border-radius:var(--r2);padding:10px;
      display:grid;
      grid-template-columns: 1fr 1fr 1fr 1fr 1fr 56px;
      gap:10px;
      box-shadow:0 18px 40px rgba(0,0,0,.20);
      align-items:stretch;
      border:1px solid rgba(255,255,255,.12);
    }
    .field{
      border:1px solid var(--line);
      border-radius:12px;
      padding:10px 10px;
      text-align:left;background:#fff;
      min-height:72px;
      display:flex;
      flex-direction:column;
      justify-content:flex-start;
    }
    .field label{display:block;font-size:11px;color:#7b8796;margin-bottom:6px;font-weight:900}
    .field input{width:100%;border:none;outline:none;font-size:16px;color:var(--text);font-weight:900}
    .searchBtn{height:100%;border:none;border-radius:12px;background:var(--blue);color:#fff;cursor:pointer;font-weight:900;display:grid;place-items:center}
    .searchBtn:hover{background:var(--blue2)}

    .salaryBox{display:flex;gap:8px;align-items:center;margin-top:2px}
    .salaryBox .mini{
      width:100%;
      border:1px solid var(--line);
      border-radius:12px;
      padding:8px 10px;
      font-weight:900;
      outline:none;
      min-width:0;
      font-size:16px;
      background:#fff;
    }
    .salaryBox .sep{width:22px;text-align:center;color:var(--muted);font-weight:900;font-size:18px;line-height:1;margin-top:2px}

    .availRow{display:flex;align-items:center;gap:10px;margin-top:6px}
    .availRow input[type="range"]{width:100%}
    .pillMini{border:1px solid var(--line);border-radius:999px;padding:8px 12px;font-size:12px;font-weight:900;color:#294a9a;background:var(--chip);white-space:nowrap}

    /* Self-service banner */
    .ssBanner{
      width:min(1060px, 98%);
      margin-top:12px;
      border-radius:24px;
      background:linear-gradient(180deg, #062b3a, #053044);
      color:#fff;
      border:1px solid rgba(255,255,255,.10);
      box-shadow:0 14px 36px rgba(0,0,0,.22);
      padding:18px 18px;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:14px;
      text-align:center;
    }
    .ssBanner h3{margin:0;font-weight:900;font-size:30px;letter-spacing:-.3px;text-align:center}
    .ssBanner p{margin:0;color:rgba(255,255,255,.78);max-width:780px;font-size:14px;line-height:1.35;text-align:center}

    /* Buttons */
    .btn{
      border:1px solid var(--line);background:#fff;border-radius:12px;
      padding:10px 12px;cursor:pointer;font-weight:900;color:#243447;
      display:inline-flex;gap:8px;align-items:center;
    }
    .btn.primary{background:var(--blue);border-color:var(--blue);color:#fff}
    .btn.primary:hover{background:var(--blue2)}
    .btn:disabled{opacity:.55;cursor:not-allowed}

    /* Cards */
    .sectionTitleRow{display:flex;align-items:center;justify-content:space-between;margin:18px 0 10px}
    .h2{font-size:22px;margin:0;font-weight:900;letter-spacing:-.2px}
    .ghost{border:1px solid var(--line);background:#fff;border-radius:12px;padding:10px 12px;cursor:pointer;color:#374151;font-weight:900}
    .grid4{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    .card{background:var(--card);border:1px solid var(--line);border-radius:var(--r2);box-shadow:var(--shadow)}
    .cardPad{padding:14px}

    .talCard{padding:14px;cursor:pointer;transition:transform .08s ease}
    .talCard:hover{transform:translateY(-1px)}
    .talTop{display:flex;gap:10px;align-items:center;margin-bottom:8px}
    .talPic{
      width:44px;height:44px;border-radius:999px;
      background: radial-gradient(circle at 30% 30%, #fff, #dbeafe);
      border:3px solid #e9e5ff;position:relative;overflow:hidden;
    }
    .talPic::after{
      content:"";position:absolute;inset:-20%;
      background:repeating-linear-gradient(45deg, rgba(0,0,0,.08), rgba(0,0,0,.08) 8px, transparent 8px, transparent 18px);
      opacity:.25;
    }
    .talName{font-weight:900;display:flex;gap:6px;align-items:center}
    .badge{font-size:11px;padding:3px 8px;border-radius:999px;border:1px solid var(--line);color:#334155;background:#fff;font-weight:900}
    .badge.green{background:#eafff2;border-color:#bdf2d6;color:#0f7a44}
    .muted{color:var(--muted)}
    .tiny{font-size:12px}
    .metaRow{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin:8px 0 10px;color:var(--muted);font-size:13px}
    .metaRow b{color:var(--text)}
    .chipRow{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
    .chip{font-size:12px;padding:6px 10px;border-radius:999px;background:var(--chip);border:1px solid var(--chipLine);color:#294a9a;font-weight:900}

    /* Marketplace layout */
    .market{display:grid;grid-template-columns:1.05fr 1.45fr;gap:14px;align-items:start}
    .talList{display:grid;gap:12px}
    .detail{padding:14px}
    .detailTop{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:12px}
    .detailTopLeft{display:flex;gap:10px;align-items:center}
    .detailName{font-weight:900}
    .detailRole{color:var(--muted);font-size:13px;margin-top:2px}
    .ctaRow{display:flex;gap:10px;flex-wrap:nowrap;align-items:center}
    .ctaRow .btn{white-space:nowrap}

    .panel{border:1px solid var(--line);border-radius:var(--r2);padding:14px;background:#fff;box-shadow:var(--shadow);margin-top:12px}
    .panelTitle{font-weight:900;margin:0 0 10px;display:flex;align-items:center;gap:8px}
    .twoPanel{display:grid;grid-template-columns:1fr;gap:12px}

    /* Video mock */
    .videoMock{
      border:1px solid var(--line);border-radius:var(--r2);overflow:hidden;
      background:#0b2f4a;position:relative;height:260px;display:block;
    }
    .videoMock .cap{
      position:absolute;left:18px;bottom:54px;
      color:#fff;font-weight:900;font-size:44px;line-height:1.02;
      text-shadow:0 4px 18px rgba(0,0,0,.35);
    }
    .videoMock .time{
      position:absolute;left:16px;bottom:14px;
      color:rgba(255,255,255,.92);font-size:13px;font-weight:900;
      background:rgba(0,0,0,.22);padding:7px 12px;border-radius:999px;
      backdrop-filter: blur(6px);
      display:inline-flex;gap:10px;align-items:center;
    }
    .videoMock .thumb{position:absolute;right:0;top:0;bottom:0;width:44%;background:linear-gradient(180deg, rgba(255,255,255,.18), rgba(255,255,255,.06))}
    .videoMock .thumb::after{
      content:"PROTECTED";position:absolute;inset:0;display:grid;place-items:center;
      color:rgba(255,255,255,.20);font-weight:900;letter-spacing:2px;transform:rotate(-14deg);
    }

    /* Employee Cost accordion (collapsed by default) */
    .acc{
      border:1px solid var(--line);
      border-radius:var(--r2);
      background:#fff;
      box-shadow:var(--shadow);
      margin-top:12px;
      overflow:hidden;
    }
    .accHead{
      padding:14px;
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      cursor:pointer; user-select:none;
      background:#fff;
    }
    .accHead .title{font-weight:900}
    .accHead .chev{font-size:18px;color:var(--muted);font-weight:900;transition:transform .18s ease}
    .acc.open .chev{transform:rotate(180deg)}
    .accBody{display:none;padding:0 14px 14px;border-top:1px solid var(--line);background:#fff}
    .acc.open .accBody{display:block}
    .costTable{width:100%;border-collapse:collapse;font-size:13px}
    .costTable td{padding:6px 0;color:#334155}
    .costTable td:last-child{text-align:right;font-weight:900;color:#111827}
    .subRow{color:#64748b}
    .indent{padding-left:14px;border-left:2px solid #eef2ff}

    /* Bullets */
    .bullets{margin:8px 0 0;padding-left:18px;color:#3b4a5c;font-size:13px;line-height:1.45}

    /* Overlay / Modal */
    .overlay{
      position:fixed; inset:0;
      background:rgba(15,23,42,.42);
      display:none;
      z-index:100;
      padding:18px;
      overflow:auto;
      -webkit-overflow-scrolling: touch;
      align-items:flex-start;
      justify-content:center;
    }
    .overlay.show{display:flex}
    .modal{
      width:min(1040px,98vw);
      background:#fff;border-radius:16px;border:1px solid var(--line);
      box-shadow:var(--shadow2);
      overflow:hidden;
      margin:18px auto;
    }
    .modalHead{padding:14px 16px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--line);background:#fff;position:sticky;top:0;z-index:2}
    .modalHead h3{margin:0;font-size:16px;font-weight:900}
    .x{width:36px;height:36px;border-radius:12px;border:1px solid var(--line);background:#fff;cursor:pointer;font-weight:900}
    .modalBody{padding:16px;max-height: calc(100vh - 140px);overflow:auto;-webkit-overflow-scrolling: touch}
    .modalFoot{padding:12px 16px;border-top:1px solid var(--line);display:flex;justify-content:flex-end;gap:10px;background:#fafbff;flex-wrap:wrap}

    /* Toast */
    .toast{
      position:fixed;right:16px;bottom:16px;background:#fff;border:1px solid var(--line);
      border-radius:14px;padding:12px 14px;box-shadow:var(--shadow);
      display:none;z-index:200;width:min(360px,92vw);
    }
    .toast.show{display:block}
    .toast h4{margin:0 0 4px;font-size:13px}
    .toast p{margin:0;color:var(--muted);font-size:12px}

    /* --- ONBOARDING WORKFLOW --- */
    .wizard2{display:grid;grid-template-columns:1.25fr .95fr;gap:14px}
    .box{
      border:1px solid var(--line);
      border-radius:16px;
      background:#fff;
      box-shadow:var(--shadow);
      padding:14px;
    }
    .box h4{margin:0 0 8px;font-size:14px;font-weight:900}
    .box p{margin:0 0 10px;color:var(--muted);font-size:12px;line-height:1.35}

    .reqBanner{
      border:1px solid #cfe0ff;
      background:#f2f7ff;
      border-radius:16px;
      padding:14px;
      color:#1f2a37;
      font-weight:900;
      margin-bottom:12px;
    }

    .row{display:flex;gap:10px;flex-wrap:wrap}
    .row > *{flex:1}
    .in{
      width:100%;
      border:1px solid var(--line);
      border-radius:12px;
      padding:10px 12px;
      font-weight:900;
      outline:none;
      font-size:13px;
      background:#fff;
    }
    .reqLabel{font-weight:900;color:#334155;font-size:12px;margin:12px 0 6px}
    .reqReq{color:#ef4444;margin-left:6px}

    .progressWrap{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .barOuter{width:100%;height:10px;border-radius:999px;background:#edf1fa;border:1px solid var(--line);overflow:hidden}
    .barInner{height:100%;background:linear-gradient(90deg, var(--blue), #62b0ff);border-radius:999px}
    .statusList{display:grid;gap:10px;margin-top:10px}
    .statusItem{
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      border:1px solid var(--line);border-radius:14px;padding:10px 12px;background:#fff;
    }
    .statusItem b{font-size:13px}
    .pillStatus{
      font-size:12px;font-weight:900;padding:6px 10px;border-radius:999px;border:1px solid var(--line);
      background:#fff;color:#334155;
    }
    .pillStatus.done{background:#eafff2;border-color:#bdf2d6;color:#0f7a44}
    .pillStatus.pending{background:#fff7e6;border-color:#ffe2b0;color:#7a4b00}
    .dotGreen{width:10px;height:10px;border-radius:999px;background:var(--success);display:inline-block;margin-right:8px}
    .dotGray{width:10px;height:10px;border-radius:999px;background:#cbd5e1;display:inline-block;margin-right:8px}
    .tag{display:inline-flex;gap:8px;align-items:center;font-size:12px;font-weight:900;color:#294a9a;background:var(--chip);border:1px solid var(--chipLine);padding:6px 10px;border-radius:999px}

    /* Start hiring box (replaces demo outputs) */
    .startHireBox{
      border:1px solid var(--line);
      border-radius:16px;
      background:#fff;
      box-shadow:var(--shadow);
      padding:14px;
    }
    .startHireBtn{
      width:100%;
      justify-content:center;
      padding:14px 12px;
      border-radius:16px;
      font-size:18px;
    }

    /* Filters modal */
    .filterGrid{display:grid;grid-template-columns:1fr;gap:14px}
    .workPref{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px}
    .pref{
      border:1px solid var(--line);
      border-radius:14px;
      padding:14px;
      text-align:center;
      cursor:pointer;
      background:#fff;
      user-select:none;
    }
    .pref .ico{font-size:30px;opacity:.8}
    .pref .lbl{margin-top:8px;font-weight:900;color:#334155;font-size:12px}
    .pref.active{outline:2px solid rgba(31,111,255,.35);background:#f7faff}

    .hist{
      height:54px;border-radius:12px;border:1px solid var(--line);
      background:linear-gradient(180deg,#ffffff,#fafcff);
      display:flex;align-items:flex-end;gap:2px;padding:8px;overflow:hidden;
    }
    .bar{width:7px;border-radius:4px 4px 0 0;background:rgba(31,111,255,.85)}
    .chipsBox{border:1px solid var(--line);border-radius:16px;padding:12px;background:#fff}
    .chipsInput{display:flex;gap:10px;flex-wrap:wrap}
    .chipX{display:inline-flex;gap:8px;align-items:center;border:1px solid var(--line);background:#fff;border-radius:999px;padding:8px 10px;font-weight:900;font-size:12px}
    .chipX button{border:none;background:transparent;cursor:pointer;font-weight:900;color:#94a3b8}
    .addSkill{border:none;outline:none;font-weight:900;color:#64748b;min-width:120px}

    .profRow{display:flex;gap:10px;flex-wrap:wrap}
    .profBtn{border:1px solid var(--line);background:#fff;border-radius:999px;padding:10px 12px;font-weight:900;cursor:pointer;display:flex;gap:8px;align-items:center}
    .profBtn.active{border-color:#b7d2ff;background:#eef3ff;color:#1f4fb6}

    /* MULTI-SELECT DROPDOWN WITH CHECKBOXES */
    .ms{position:relative}
    .msControl{
      width:100%;
      border:1px solid var(--line);
      border-radius:12px;
      padding:10px 12px;
      background:#fff;
      cursor:pointer;
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      font-weight:900;
      font-size:13px;
      user-select:none;
    }
    .msControl .ph{color:#94a3b8;font-weight:900}
    .msControl .val{color:#111827;font-weight:900;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
    .msMenu{
      position:absolute;
      left:0; right:0;
      top:calc(100% + 8px);
      background:#fff;
      border:1px solid var(--line);
      border-radius:12px;
      box-shadow:var(--shadow);
      padding:10px;
      z-index:5;
      display:none;
    }
    .ms.open .msMenu{display:block}
    .msSearch{
      width:100%;
      border:1px solid var(--line);
      border-radius:12px;
      padding:10px 12px;
      font-weight:900;
      outline:none;
      margin-bottom:10px;
    }
    .msList{
      max-height:180px;
      overflow:auto;
      border:1px solid var(--line);
      border-radius:12px;
      padding:8px;
    }
    .msOpt{
      display:flex;align-items:center;gap:10px;
      padding:8px 8px;
      border-radius:10px;
      cursor:pointer;
      font-weight:900;
      color:#334155;
    }
    .msOpt:hover{background:#f7faff}
    .msOpt input{width:18px;height:18px}

    /* Training quick-tour card (onboarding right column) */
    .tourBox{
      border:1px solid #cfe0ff;
      background:#f2f7ff;
      border-radius:16px;
      padding:14px;
      box-shadow:var(--shadow);
    }
    .tourTitle{font-weight:900;font-size:14px;margin:0 0 6px}
    .tourSub{margin:0 0 10px;color:#536071;font-size:12px;font-weight:800;line-height:1.35}
    .tourActions{display:flex;gap:10px;flex-wrap:wrap}
    .tourActions .btn{flex:1;justify-content:center}
    .miniVid{
      margin-top:10px;
      height:120px;
      border-radius:16px;
      border:1px solid rgba(0,0,0,.08);
      background:linear-gradient(180deg,#0b2f4a,#0a3552);
      position:relative;
      overflow:hidden;
    }
    .miniVid .cap{position:absolute;left:14px;bottom:44px;color:#fff;font-weight:900;font-size:20px;line-height:1.05}
    .miniVid .time{position:absolute;left:12px;bottom:12px;color:rgba(255,255,255,.92);font-size:12px;font-weight:900;background:rgba(0,0,0,.22);padding:6px 10px;border-radius:999px;backdrop-filter:blur(6px)}
    .miniVid .thumb{position:absolute;right:0;top:0;bottom:0;width:42%;background:linear-gradient(180deg, rgba(255,255,255,.18), rgba(255,255,255,.06))}
    .miniVid .thumb::after{content:"ETM";position:absolute;inset:0;display:grid;place-items:center;color:rgba(255,255,255,.20);font-weight:900;letter-spacing:2px;transform:rotate(-14deg)}

    /* NEW: checkbox rows (onboarding) */
    .checkRow{
      display:flex;
      align-items:flex-start;
      gap:10px;
      margin-top:10px;
      padding:10px 12px;
      border:1px solid var(--line);
      border-radius:12px;
      background:#fff;
    }
    .checkRow input[type="checkbox"]{width:18px;height:18px;margin-top:2px}
    .checkRow .txt{font-weight:900;color:#334155;font-size:12px;line-height:1.25}
    .checkRow .sub{display:block;margin-top:4px;color:#6b7280;font-weight:800;font-size:12px}

    /* Chatbot widget */
    .chatFab{
      position:fixed;
      right:16px;
      bottom:16px;
      z-index:250;
      width:56px;height:56px;
      border-radius:16px;
      border:1px solid rgba(0,0,0,.08);
      background:var(--blue);
      color:#fff;
      font-weight:900;
      cursor:pointer;
      box-shadow:var(--shadow);
      display:grid;place-items:center;
    }
    .chatFab:hover{background:var(--blue2)}
    .chatWin{
      position:fixed;
      right:16px;
      bottom:82px;
      z-index:250;
      width:min(360px, 92vw);
      height:460px;
      background:#fff;
      border:1px solid var(--line);
      border-radius:18px;
      box-shadow:var(--shadow2);
      display:none;
      overflow:hidden;
    }
    .chatWin.show{display:flex;flex-direction:column}
    .chatHead{
      padding:12px 12px;
      border-bottom:1px solid var(--line);
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      background:#fff;
    }
    .chatHead .t{
      display:flex;align-items:center;gap:10px;
      font-weight:900;
    }
    .chatBadge{
      font-size:11px;font-weight:900;
      padding:4px 8px;border-radius:999px;
      background:var(--chip);border:1px solid var(--chipLine);
      color:#294a9a;
    }
    .chatClose{
      width:34px;height:34px;border-radius:12px;border:1px solid var(--line);background:#fff;cursor:pointer;font-weight:900;
    }
    .chatBody{
      padding:12px;
      overflow:auto;
      display:flex;flex-direction:column;gap:10px;
      background:#fbfcff;
      flex:1;
    }
    .msg{
      max-width:85%;
      border-radius:16px;
      padding:10px 12px;
      font-size:13px;
      line-height:1.35;
      border:1px solid rgba(0,0,0,.06);
      box-shadow:0 6px 18px rgba(0,0,0,.06);
      font-weight:800;
    }
    .msg.user{align-self:flex-end;background:#eaf2ff;border-color:#cfe0ff;color:#123a78}
    .msg.bot{align-self:flex-start;background:#fff;border-color:#e6eaf2;color:#1f2a37}
    .chatFoot{
      padding:10px;
      border-top:1px solid var(--line);
      display:flex;gap:10px;
      background:#fff;
    }
    .chatInput{
      flex:1;
      border:1px solid var(--line);
      border-radius:12px;
      padding:10px 12px;
      font-weight:900;
      outline:none;
      font-size:13px;
    }
    .chatSend{
      border:1px solid var(--blue);
      background:var(--blue);
      color:#fff;
      border-radius:12px;
      padding:10px 12px;
      font-weight:900;
      cursor:pointer;
      min-width:80px;
    }
    .chatSend:hover{background:var(--blue2);border-color:var(--blue2)}

    @media (max-width: 1100px){
      .searchBar{grid-template-columns:1fr 1fr;}
      .searchBtn{grid-column: 1 / -1; min-height:52px;}
    }
    @media (max-width: 980px){
      .market{grid-template-columns:1fr}
      .grid4{grid-template-columns:1fr}
      .wizard2{grid-template-columns:1fr}
      .twoPanel{grid-template-columns:1fr}
      .workPref{grid-template-columns:1fr}
      .chatWin{height:420px}
    }
  </style>
</head>
<body>

  <!-- Top Navigation -->
  <div class="top">
    <div class="topInner">
      <div style="display:flex; align-items:center; gap:16px;">
        <div class="brand" aria-label="Emapta">
          <div class="brandText">Emapta</div>
        </div>
        <div class="navLinks">
          <a href="#" data-route="landing" class="active" id="navLanding">Marketplace</a>
          <a href="#" data-route="market" id="navMarket">Jobs</a>
          <a href="#" data-route="saved" id="navSaved">Saved</a>
        </div>
      </div>

      <div class="rightControls">
        <div class="pill"><span>üá∫üá∏</span><strong style="color:#111827">USD</strong><span>‚ñæ</span></div>
        <div class="avatar" title="User">JD</div>
        <button class="iconBtn" id="menuBtn" title="Menu">‚â°</button>
      </div>
    </div>
  </div>

  <!-- LANDING -->
  <section id="pageLanding">
    <div class="hero">
      <div class="heroInner">
        <h1 class="heroTitle">Find and hire top talent, <span class="accent">fast.</span></h1>

        <div class="searchBar">
          <div class="field">
            <label>Role</label>
            <input id="roleInput" placeholder="Job title or skill" value="Accountant" />
          </div>

          <div class="field">
            <label>Location</label>
            <input id="locInput" placeholder="City or country" value="North Macedonia" />
          </div>

          <div class="field">
            <label>Experience</label>
            <input id="expInput" placeholder="Years or location" value="3 Years" />
          </div>

          <div class="field">
            <label>Salary range (USD / month)</label>
            <div class="salaryBox">
              <input class="mini" id="salMin" inputmode="numeric" placeholder="Min" value="1000" />
              <div class="sep">‚Äî</div>
              <input class="mini" id="salMax" inputmode="numeric" placeholder="Max" value="5000" />
            </div>
          </div>

          <div class="field">
            <label>Availability</label>
            <div class="availRow">
              <input id="availDays" type="range" min="0" max="90" value="30" />
              <span class="pillMini" id="availLabel">‚â§ 30 days</span>
            </div>
          </div>

          <button class="searchBtn" id="heroSearchBtn" title="Search">üîé</button>
        </div>

        <div class="ssBanner">
          <h3>Great talents based on your Job Requests</h3>
          <p>New here? Try the 2-minute self-service setup ‚Äî we‚Äôll guide you step-by-step and you‚Äôll see matching talent instantly.</p>
          <button class="btn primary" id="startOnboardingBtn">Start self-service onboarding</button>
        </div>
      </div>
    </div>

    <div class="wrap">
      <div class="sectionTitleRow" style="margin-top:8px;">
        <h2 class="h2">Handpicked for you</h2>
        <button class="ghost" id="viewMoreBtn">View more</button>
      </div>

      <div class="grid4" id="handpickedRow"></div>
    </div>
  </section>

  <!-- JOBS / MARKETPLACE -->
  <section id="pageMarket" style="display:none;">
    <div class="wrap">
      <div class="sectionTitleRow" style="margin-top:0;">
        <h2 class="h2">Marketplace <span class="muted" id="countText">(1,079 talents)</span></h2>
        <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
          <button class="btn" id="openFiltersBtn">Filters ‚ñæ</button>
          <button class="btn" id="advancedBtn">Advanced search</button>
          <button class="btn" id="semanticBtn">Semantic search</button>
          <button class="btn primary" id="goToOnboardingMini">New client onboarding</button>
        </div>
      </div>

      <div class="market">
        <div class="leftCol">
          <div class="talList" id="talList"></div>
        </div>

        <div class="card detail" id="detailPanel"></div>
      </div>
    </div>
  </section>

  <!-- SAVED -->
  <section id="pageSaved" style="display:none;">
    <div class="wrap">
      <h2 class="h2" style="margin-top:0;">Saved talents</h2>
      <p class="muted">This simulator stores ‚Äúsaved‚Äù in memory only for this page session.</p>
      <div id="savedList" class="talList"></div>
    </div>
  </section>

  <!-- SELF-SERVICE CLIENT ONBOARDING -->
  <div class="overlay" id="onboardOverlay" aria-hidden="true">
    <div class="modal">
      <div class="modalHead">
        <h3>Self-Service Client Onboarding / New Hiring Request</h3>
        <div style="display:flex; gap:10px; align-items:center;">
          <button class="btn" id="resetOnboardBtn" title="Clear all fields + reset readiness">Reset demo</button>
          <button class="x" data-close="onboardOverlay">‚úï</button>
        </div>
      </div>

      <div class="modalBody">
        <div class="wizard2">
          <!-- LEFT COLUMN -->
          <div style="display:grid; gap:12px;">

            <div class="box">
              <div class="reqBanner">Complete the fields below to reach 100% readiness.</div>

              <div class="reqLabel">Which roles are you hiring for?<span class="reqReq">*</span></div>
              <input class="in" id="reqRole" placeholder="e.g., Accountant, Payroll Specialist" />

              <div class="reqLabel">How many?<span class="reqReq">*</span></div>
              <input class="in" id="reqCount" inputmode="numeric" placeholder="e.g., 12" />

              <div class="reqLabel">Start date<span class="reqReq">*</span></div>
              <input class="in" id="reqStartDate" type="date" />

              <div style="margin-top:12px;">
                <button class="btn primary" id="saveReqBtn" style="width:100%;justify-content:center;">Save hiring request</button>
                <div class="muted tiny" id="reqStatusText" style="font-weight:900;margin-top:8px;">Hiring request details not set.</div>
              </div>
            </div>

            <div class="box">
              <h4>Hiring manager</h4>

              <!-- NEW: self checkbox -->
              <div class="checkRow">
                <input type="checkbox" id="hmSelf" />
                <div class="txt">
                  I am the hiring manager.
                  <span class="sub" id="hmSelfSub">If selected, we‚Äôll prefill your details.</span>
                </div>
              </div>

              <div class="row" style="margin-top:10px;">
                <input class="in" id="hmName" placeholder="Name" />
                <input class="in" id="hmEmail" placeholder="Email" />
              </div>

              <!-- NEW: certification checkbox -->
              <div class="checkRow" style="margin-top:10px;">
                <input type="checkbox" id="hmCert" />
                <div class="txt">
                  Hiring manager is on my team and listed in our Emapta company profile.
                </div>
              </div>

              <div class="row" style="margin-top:10px;align-items:center;">
                <button class="btn" id="addHmBtn" style="flex:0 0 auto;">Add</button>
                <div class="muted tiny" id="hmAddedText" style="align-self:center;font-weight:900;">No hiring manager added yet.</div>
              </div>

              <div style="margin-top:16px;">
                <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap;">
                  <h4 style="margin:0;">Job Requirements</h4>
                  <label class="btn" style="cursor:pointer;">
                    Attach JD
                    <input type="file" id="jdFile" style="display:none" />
                  </label>
                </div>
                <div class="muted tiny" id="jdStatusText" style="font-weight:900;margin-top:8px;">No JD provided yet.</div>

                <!-- REQUIRED fields immediately visible -->
                <div class="reqLabel" style="margin-top:14px;">Technical Skills<span class="reqReq">*</span></div>
                <div class="ms" id="techSkillsMS"></div>

                <div class="muted tiny" style="font-weight:900;margin-top:6px;">Tip: hold Ctrl/Cmd to select multiple.</div>

                <div class="reqLabel" style="margin-top:14px;">Soft Skills<span class="reqReq">*</span></div>
                <div class="ms" id="softSkillsMS"></div>

                <div class="reqLabel" style="margin-top:14px;">Work Arrangement<span class="reqReq">*</span></div>
                <div class="ms" id="workArrangementMS"></div>

                <div class="reqLabel" style="margin-top:14px;">Work Schedule<span class="reqReq">*</span></div>
                <div class="ms" id="workScheduleMS"></div>

                <div class="reqLabel" style="margin-top:14px;">Time Zone<span class="reqReq">*</span></div>
                <div class="ms" id="timeZoneMS"></div>

                <div style="margin-top:10px;">
                  <button class="btn" id="saveJobReqBtn" style="width:100%;justify-content:center;">Save job requirements</button>
                  <div class="muted tiny" id="jobReqStatusText" style="font-weight:900;margin-top:8px;">Job requirements not set.</div>
                </div>
              </div>

              <div style="margin-top:16px;">
                <h4 style="margin:0 0 8px;">Price range (monthly)</h4>
                <div class="row">
                  <input class="in" id="priceMin" inputmode="numeric" placeholder="Min (USD)" />
                  <input class="in" id="priceMax" inputmode="numeric" placeholder="Max (USD)" />
                  <button class="btn" id="savePriceBtn" style="flex:0 0 auto;">Save</button>
                </div>
                <div class="muted tiny" id="priceStatusText" style="font-weight:900;margin-top:8px;">Price range not set.</div>
              </div>

              <div style="margin-top:16px;">
                <h4 style="margin:0 0 8px;">Invite hiring managers (viral growth)</h4>
                <p>Add hiring managers from other locations and departments to spread ETM usage across the client organization.</p>
                <div class="row" style="margin-top:8px;">
                  <input class="in" id="inviteEmail" placeholder="Hiring manager email" />
                  <select class="in" id="inviteDept" style="font-weight:900;">
                    <option>Operations</option>
                    <option>Finance</option>
                    <option>Customer Support</option>
                    <option>IT</option>
                    <option>Sales</option>
                    <option>HR</option>
                  </select>
                </div>
                <div class="row" style="margin-top:10px;">
                  <select class="in" id="inviteLoc" style="font-weight:900;">
                    <option>Madrid</option>
                    <option>Barcelona</option>
                    <option>Valencia</option>
                    <option>Seville</option>
                    <option>Lisbon</option>
                    <option>London</option>
                  </select>
                  <button class="btn primary" id="sendInviteBtn" style="flex:0 0 auto;">Send invite</button>
                </div>
                <div id="inviteList" style="margin-top:10px;display:grid;gap:8px;"></div>
              </div>
            </div>
          </div>

          <!-- RIGHT COLUMN -->
          <div style="display:grid; gap:12px;">
            <!-- Quick tour -->
            <div class="tourBox">
              <div class="tourTitle">New client quick tour</div>
              <div class="tourSub">Start here: watch the 2-minute training video, or choose the ‚ÄúDo it with me‚Äù guided walkthrough.</div>
              <div class="tourActions">
                <button class="btn primary" id="watch2minBtn">Watch 2-minute training</button>
                <button class="btn" id="doItWithMeBtn">Do it with me</button>
              </div>
              <div class="miniVid" aria-label="2-minute training video mock">
                <div class="cap">2-minute<br/>Training</div>
                <div class="time">00 &nbsp; üîä &nbsp; 0:12 / 2:00</div>
                <div class="thumb"></div>
              </div>
            </div>

            <div class="box">
              <div class="progressWrap">
                <div style="font-weight:900;font-size:18px;">Hiring engine readiness</div>
                <div class="pillStatus" id="readinessPctPill">82%</div>
              </div>
              <div style="margin-top:10px;">
                <div class="barOuter">
                  <div class="barInner" id="readinessBar" style="width:82%"></div>
                </div>
              </div>

              <div class="statusList" style="margin-top:12px;">
                <div class="statusItem">
                  <div style="display:flex;align-items:center;gap:8px;">
                    <span class="dotGreen"></span><b>Company profile fetched (auto)</b>
                  </div>
                  <span class="pillStatus done">Done</span>
                </div>
                <div class="statusItem">
                  <div style="display:flex;align-items:center;gap:8px;">
                    <span class="dotGreen"></span><b>Compliance configured (auto)</b>
                  </div>
                  <span class="pillStatus done">Done</span>
                </div>

                <div class="statusItem">
                  <div style="display:flex;align-items:center;gap:8px;">
                    <span class="dotGray"></span><b>Hiring request details</b>
                  </div>
                  <span class="pillStatus pending" id="stReq">Pending</span>
                </div>
                <div class="statusItem">
                  <div style="display:flex;align-items:center;gap:8px;">
                    <span class="dotGray"></span><b>Add hiring manager</b>
                  </div>
                  <span class="pillStatus pending" id="stHm">Pending</span>
                </div>
                <div class="statusItem">
                  <div style="display:flex;align-items:center;gap:8px;">
                    <span class="dotGray"></span><b>Job requirements</b>
                  </div>
                  <span class="pillStatus pending" id="stJobReq">Pending</span>
                </div>
                <div class="statusItem">
                  <div style="display:flex;align-items:center;gap:8px;">
                    <span class="dotGray"></span><b>Provide price range</b>
                  </div>
                  <span class="pillStatus pending" id="stPrice">Pending</span>
                </div>
              </div>
            </div>

            <div class="box">
              <h4>Auto-fetched from Emapta database</h4>
              <div class="muted tiny" style="font-weight:900;">Company profile ‚Ä¢ Compliance defaults ‚Ä¢ Contract entity ‚Ä¢ Billing profile</div>
              <div style="margin-top:10px;display:flex;gap:10px;flex-wrap:wrap;">
                <span class="tag">Verified client</span>
                <span class="tag">Compliance ready</span>
                <span class="tag">Billing mapped</span>
              </div>
            </div>

            <div class="startHireBox">
              <button class="btn primary startHireBtn" id="startHiringBtn" disabled>Start hiring</button>
              <div class="muted tiny" id="startHiringHint" style="font-weight:900;margin-top:10px;">
                Complete all pending items to enable Start hiring.
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="modalFoot">
        <button class="btn" data-close="onboardOverlay">Close</button>
      </div>
    </div>
  </div>

  <!-- FILTERS MODAL -->
  <div class="overlay" id="filtersOverlay" aria-hidden="true">
    <div class="modal" style="width:min(560px,98vw);">
      <div class="modalHead">
        <h3>Filters</h3>
        <button class="x" data-close="filtersOverlay">‚úï</button>
      </div>
      <div class="modalBody">
        <div class="filterGrid">
          <div>
            <div class="muted tiny" style="font-weight:900;margin-bottom:8px;">Work Preference</div>
            <div class="workPref">
              <div class="pref active" data-pref="wfh">
                <div class="ico">üè†</div>
                <div class="lbl">Work From Home</div>
              </div>
              <div class="pref" data-pref="onsite">
                <div class="ico">üè¢</div>
                <div class="lbl">On-site</div>
              </div>
              <div class="pref" data-pref="hybrid">
                <div class="ico">üèôÔ∏è</div>
                <div class="lbl">Hybrid</div>
              </div>
            </div>
          </div>

          <div>
            <div class="muted tiny" style="font-weight:900;margin-bottom:8px;">Talent Monthly Cost</div>
            <div class="hist" aria-label="histogram">
              <div class="bar" style="height:6px"></div><div class="bar" style="height:8px"></div><div class="bar" style="height:10px"></div>
              <div class="bar" style="height:12px"></div><div class="bar" style="height:14px"></div><div class="bar" style="height:16px"></div>
              <div class="bar" style="height:18px"></div><div class="bar" style="height:22px"></div><div class="bar" style="height:26px"></div>
              <div class="bar" style="height:30px"></div><div class="bar" style="height:34px"></div><div class="bar" style="height:38px"></div>
              <div class="bar" style="height:42px"></div><div class="bar" style="height:46px"></div><div class="bar" style="height:40px"></div>
              <div class="bar" style="height:34px"></div><div class="bar" style="height:28px"></div><div class="bar" style="height:22px"></div>
              <div class="bar" style="height:16px"></div><div class="bar" style="height:12px"></div><div class="bar" style="height:10px"></div>
            </div>
            <div class="row" style="margin-top:10px;">
              <input class="in" id="fMin" value="100" />
              <div style="flex:0 0 auto;align-self:center;font-weight:900;color:var(--muted);">USD</div>
              <div style="flex:0 0 auto;align-self:center;font-weight:900;color:var(--muted);">‚Äî</div>
              <input class="in" id="fMax" value="5000" />
              <div style="flex:0 0 auto;align-self:center;font-weight:900;color:var(--muted);">USD</div>
            </div>
          </div>

          <div class="chipsBox">
            <div class="muted tiny" style="font-weight:900;margin-bottom:8px;">Technical Skills</div>
            <div class="chipsInput" id="techChips">
              <span class="chipX">Figma <button data-x="Figma">√ó</button></span>
              <span class="chipX">Adobe Photoshop <button data-x="Adobe Photoshop">√ó</button></span>
              <span class="chipX">Information Architecture <button data-x="Information Architecture">√ó</button></span>
              <span class="chipX">Prototyping <button data-x="Prototyping">√ó</button></span>
              <span class="chipX">Wireframing <button data-x="Wireframing">√ó</button></span>
              <span class="chipX">UX Research <button data-x="UX Research">√ó</button></span>
              <input class="addSkill" id="techAdd" placeholder="Add skill" />
            </div>
          </div>

          <div class="chipsBox">
            <div class="muted tiny" style="font-weight:900;margin-bottom:8px;">Soft Skills</div>
            <div class="chipsInput" id="softChips">
              <span class="chipX">Teamwork <button data-x="Teamwork">√ó</button></span>
              <span class="chipX">Team Management <button data-x="Team Management">√ó</button></span>
              <span class="chipX">Conflict Resolution <button data-x="Conflict Resolution">√ó</button></span>
              <span class="chipX">Creative Thinking <button data-x="Creative Thinking">√ó</button></span>
              <span class="chipX">Public Speaking <button data-x="Public Speaking">√ó</button></span>
              <span class="chipX">Stress Management <button data-x="Stress Management">√ó</button></span>
              <input class="addSkill" id="softAdd" placeholder="Add skill" />
            </div>
          </div>

          <div>
            <div class="muted tiny" style="font-weight:900;margin-bottom:8px;">English Proficiency</div>
            <div class="profRow" id="profRow">
              <button class="profBtn" data-prof="Basic">Ôºã Basic</button>
              <button class="profBtn" data-prof="Intermediate">Ôºã Intermediate</button>
              <button class="profBtn" data-prof="Proficient">Ôºã Proficient</button>
              <button class="profBtn" data-prof="Fluent">Ôºã Fluent</button>
              <button class="profBtn" data-prof="Native">Ôºã Native</button>
            </div>
          </div>
        </div>
      </div>
      <div class="modalFoot">
        <button class="btn" id="clearFiltersBtn">Clear filters</button>
        <button class="btn primary" id="applyFiltersBtn">Filter</button>
      </div>
    </div>
  </div>

  <!-- ADVANCED SEARCH MODAL -->
  <div class="overlay" id="advancedOverlay" aria-hidden="true">
    <div class="modal" style="width:min(640px,98vw);">
      <div class="modalHead">
        <h3>Advanced Search</h3>
        <button class="x" data-close="advancedOverlay">‚úï</button>
      </div>
      <div class="modalBody" style="display:grid;gap:12px;">
        <div>
          <div class="muted tiny" style="font-weight:900;margin-bottom:6px;">All of these words</div>
          <input class="in" id="advAll" value="Accountant" />
        </div>
        <div>
          <div class="muted tiny" style="font-weight:900;margin-bottom:6px;">Any of these words</div>
          <input class="in" id="advAny" placeholder="e.g., payroll OR reconciliations" />
        </div>
        <div>
          <div class="muted tiny" style="font-weight:900;margin-bottom:6px;">None of these words</div>
          <input class="in" id="advNone" placeholder="e.g., internship" />
        </div>
        <div>
          <div class="muted tiny" style="font-weight:900;margin-bottom:6px;">The exact phrase</div>
          <input class="in" id="advExact" placeholder="e.g., month-end close" />
        </div>
      </div>
      <div class="modalFoot">
        <button class="btn" data-close="advancedOverlay">Cancel</button>
        <button class="btn primary" id="runAdvancedBtn">Search</button>
      </div>
    </div>
  </div>

  <!-- SEMANTIC SEARCH MODAL -->
  <div class="overlay" id="semanticOverlay" aria-hidden="true">
    <div class="modal" style="width:min(720px,98vw);">
      <div class="modalHead">
        <h3>Semantic Search</h3>
        <button class="x" data-close="semanticOverlay">‚úï</button>
      </div>
      <div class="modalBody" style="display:grid;gap:12px;">
        <div class="muted tiny" style="font-weight:900;">
          Ask in plain language. (Demo) The platform ‚Äúunderstands‚Äù intent and finds matching talent.
        </div>
        <textarea class="in" id="semanticInput" style="min-height:110px;resize:vertical;font-weight:800;"
          placeholder="e.g., I need a senior accountant who can handle month-end close, reconciliations, and can start within 2 weeks. Budget up to $5k/mo."></textarea>
        <div style="display:flex;gap:10px;justify-content:flex-end;flex-wrap:wrap;">
          <button class="btn" data-close="semanticOverlay">Cancel</button>
          <button class="btn primary" id="runSemanticBtn">Search</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Tour Modal -->
  <div class="overlay" id="tourOverlay" aria-hidden="true">
    <div class="modal" style="width:min(820px,98vw);">
      <div class="modalHead">
        <h3 id="tourTitle">Quick tour</h3>
        <button class="x" data-close="tourOverlay">‚úï</button>
      </div>
      <div class="modalBody" id="tourBody" style="display:grid;gap:12px;">
        <!-- injected -->
      </div>
      <div class="modalFoot">
        <button class="btn" data-close="tourOverlay">Close</button>
      </div>
    </div>
  </div>

  <!-- Toast -->
  <div class="toast" id="toast">
    <h4 id="toastTitle">Done</h4>
    <p id="toastMsg">Action complete.</p>
  </div>

  <!-- Chatbot -->
  <button class="chatFab" id="chatFab" title="ETM AI Chatbot">üí¨</button>
  <div class="chatWin" id="chatWin" role="dialog" aria-label="ETM AI Chatbot">
    <div class="chatHead">
      <div class="t">ETM AI <span class="chatBadge">Conversational</span></div>
      <button class="chatClose" id="chatClose">‚úï</button>
    </div>
    <div class="chatBody" id="chatBody"></div>
    <div class="chatFoot">
      <input class="chatInput" id="chatInput" placeholder="Ask a question or report an issue‚Ä¶" />
      <button class="chatSend" id="chatSend">Send</button>
    </div>
  </div>

<script>
/* =========================
   Demo data
   ========================= */
const TALENTS = [
  {
    id:"ID3308544",
    masked:"Talent ID #ID3308544",
    name:"Lydia",
    role:"Back-End Developer",
    availability:"Available now",
    city:"Quezon City, PH",
    exp:"6 years experience",
    cost:"USD 2,542.00/mo",
    skills:["AWS (Amazon Web Services)","Docker","Elasticsearch","GitLab CI/CD","Jenkins","CircleCI","Travis CI","Bamboo","GitHub Actions","TeamCity"],
    summary:[
      "Back-end engineer with experience building reliable services and improving performance.",
      "Strong ownership in production operations and CI/CD practices.",
      "Comfortable collaborating across product and engineering."
    ],
    ai:{ summary:"Strong communicator. Recommended for fast-moving teams.", comms:"High", roleFit:"Excellent" }
  },
  {
    id:"ID8211402",
    masked:"Talent ID #ID8211402",
    name:"Samuel",
    role:"Graphic Designer",
    availability:"Available now",
    city:"Toronto, CA",
    exp:"4 years experience",
    cost:"USD 3,000.00/mo",
    skills:["Figma","Illustrator","Adobe Photoshop","+5 skills"],
    summary:[
      "Strong portfolio across web and brand; fast iteration.",
      "Comfortable with design systems and prototypes."
    ],
    ai:{ summary:"Concise and structured. Strong for product design support.", comms:"Medium-High", roleFit:"Strong" }
  },
  {
    id:"ID9943318",
    masked:"Talent ID #ID9943318",
    name:"Nina",
    role:"Software Engineer",
    availability:"Available now",
    city:"Berlin, DE",
    exp:"8 years experience",
    cost:"USD 5,000.00/mo",
    skills:["Node.js","React","Postgres","+7 skills"],
    summary:[
      "Full-stack engineer with experience in scalable web services.",
      "Strong ownership; experienced with CI/CD and production ops."
    ],
    ai:{ summary:"High technical depth with practical tradeoffs.", comms:"High", roleFit:"Excellent" }
  },
  {
    id:"ID4402210",
    masked:"Talent ID #ID4402210",
    name:"Ravi",
    role:"Project Manager",
    availability:"Available now",
    city:"Mumbai, IN",
    exp:"10 years experience",
    cost:"USD 4,200.00/mo",
    skills:["Agile","Stakeholder Mgmt","Delivery","+6 skills"],
    summary:[
      "Experienced PM across distributed teams; strong planning.",
      "Excellent at aligning milestones and communicating status."
    ],
    ai:{ summary:"Clear on delivery frameworks; strong escalation instincts.", comms:"High", roleFit:"Strong" }
  },
  {
    id:"ID7719920",
    masked:"Talent ID #ID7719920",
    name:"Tim",
    role:"Software Engineer",
    availability:"Available now",
    city:"Berlin, DE",
    exp:"8 years experience",
    cost:"USD 5,000.00/mo",
    skills:["Node.js","React","Postgres","+7 skills"],
    summary:[
      "Full-stack engineer with experience in scalable web services.",
      "Strong ownership; experienced with CI/CD and production ops."
    ],
    ai:{ summary:"High technical depth with practical tradeoffs.", comms:"High", roleFit:"Excellent" }
  }
];

let saved = new Set();
let selectedId = TALENTS[0].id;

/* =========================
   Helpers
   ========================= */
function $(id){ return document.getElementById(id); }

function toast(title, msg){
  $("toastTitle").textContent = title;
  $("toastMsg").textContent = msg;
  $("toast").classList.add("show");
  setTimeout(()=> $("toast").classList.remove("show"), 2300);
}

function showRoute(route){
  $("pageLanding").style.display = route==="landing" ? "" : "none";
  $("pageMarket").style.display  = route==="market" ? "" : "none";
  $("pageSaved").style.display   = route==="saved" ? "" : "none";

  document.querySelectorAll(".navLinks a").forEach(a=>a.classList.remove("active"));
  if(route==="landing") $("navLanding").classList.add("active");
  if(route==="market") $("navMarket").classList.add("active");
  if(route==="saved") $("navSaved").classList.add("active");

  if(route==="market") renderMarket();
  if(route==="saved") renderSaved();

  if(route==="landing") resetOnboarding();
}

function openOverlay(id){
  $(id).classList.add("show");
  $(id).setAttribute("aria-hidden","false");
}
function closeOverlay(id){
  $(id).classList.remove("show");
  $(id).setAttribute("aria-hidden","true");
  if(id==="onboardOverlay") resetOnboarding();
}

/* =========================
   Landing
   ========================= */
function renderHandpicked(){
  const row = $("handpickedRow");
  row.innerHTML = "";
  TALENTS.slice(0,4).forEach(t=>{
    const el = document.createElement("div");
    el.className = "card talCard";
    el.innerHTML = `
      <div class="talTop">
        <div class="talPic" title="Protected image"></div>
        <div style="flex:1">
          <div class="talName">${t.name} <span class="badge">‚úî</span> <span class="badge">v</span></div>
          <div class="muted tiny">${t.role}</div>
        </div>
        <div class="muted tiny">‚ãÆ</div>
      </div>
      <div class="metaRow">
        <div>üü¢ <b>${t.availability}</b></div>
        <div>üí≥ <b>${t.cost}</b></div>
        <div>üìç ${t.city}</div>
        <div>üß† ${t.exp}</div>
      </div>
      <div class="tiny muted" style="font-weight:900; margin-top:10px;">Technical Skills</div>
      <div class="chipRow">
        ${t.skills.slice(0,3).map(s=>`<span class="chip">${s}</span>`).join("")}
        <span class="chip">+${Math.max(0,t.skills.length-3)} more</span>
      </div>
      <div class="tiny muted" style="font-weight:900; margin-top:10px;">Location of Experience</div>
      <div class="chipRow">
        <span class="chip">SG: 3 years</span>
        <span class="chip">US: 2 years</span>
        <span class="chip">AU: 1 year</span>
      </div>
    `;
    el.onclick = ()=>{ selectedId = t.id; showRoute("market"); };
    row.appendChild(el);
  });
}

/* =========================
   Marketplace
   ========================= */
function renderMarket(){
  $("countText").textContent = `(1,079 talents)`;

  const list = $("talList");
  list.innerHTML = "";
  TALENTS.forEach(t=>{
    const el = document.createElement("div");
    el.className = "card talCard";
    el.style.outline = (t.id===selectedId) ? "2px solid rgba(31,111,255,.35)" : "none";
    el.innerHTML = `
      <div class="talTop">
        <div class="talPic"></div>
        <div style="flex:1">
          <div class="talName">${t.name} <span class="badge">‚úî</span> <span class="badge">v</span></div>
          <div class="muted tiny">${t.role}</div>
        </div>
        <div class="muted tiny">‚ãÆ</div>
      </div>
      <div class="metaRow">
        <div>üü¢ <b>${t.availability}</b></div>
        <div>üí≥ <b>${t.cost}</b></div>
        <div>üìç ${t.city}</div>
        <div>üß† ${t.exp}</div>
      </div>
      <div class="tiny muted" style="font-weight:900; margin-top:10px;">Technical Skills</div>
      <div class="chipRow">
        ${t.skills.slice(0,3).map(s=>`<span class="chip">${s}</span>`).join("")}
        <span class="chip">+${Math.max(0,t.skills.length-3)} more</span>
      </div>
      <div class="tiny muted" style="font-weight:900; margin-top:10px;">Location of Experience</div>
      <div class="chipRow">
        <span class="chip">SG: 3 years</span>
        <span class="chip">US: 2 years</span>
        <span class="chip">AU: 1 year</span>
      </div>
    `;
    el.onclick = ()=>{ selectedId = t.id; renderMarket(); };
    list.appendChild(el);
  });

  const t = TALENTS.find(x=>x.id===selectedId) || TALENTS[0];
  $("detailPanel").innerHTML = `
    <div class="detailTop">
      <div class="detailTopLeft">
        <div class="talPic" style="width:52px;height:52px;"></div>
        <div>
          <div class="detailName">${t.name}</div>
          <div class="detailRole">${t.role}</div>
          <div class="chipRow" style="margin-top:6px">
            <span class="badge green">${t.availability}</span>
            <span class="badge"># ${t.id}</span>
          </div>
        </div>
      </div>
      <div class="ctaRow">
        <button class="btn primary" id="reqInterviewBtn">Request for interview</button>
        <button class="btn" id="viewProfileBtn">View full profile ‚Üó</button>
      </div>
    </div>

    <div class="panel">
      <div class="panelTitle">Verified by Veremark</div>
      <div class="muted tiny">This candidate has been verified and reference checked. (Demo copy)</div>
    </div>

    <div class="twoPanel">
      <div class="panel">
        <div class="panelTitle">Introduction Video</div>
        <div class="videoMock" aria-label="Protected video mock">
          <div class="cap">Talent<br/>Introduction</div>
          <div class="time">00 &nbsp; üîä &nbsp; 0:45 / 2:00</div>
          <div class="thumb"></div>
        </div>

        <div style="margin-top:12px;display:flex;gap:10px;flex-wrap:wrap;">
          <button class="btn" id="saveBtn">${saved.has(t.id) ? "Saved ‚úì" : "Save talent"}</button>
          <button class="btn" id="shareBtn">Share talent</button>
        </div>

        <div class="panel" style="margin-top:14px;box-shadow:none;">
          <div class="panelTitle">Watch Full Candidate Interview with AVAR</div>
          <div class="videoMock" aria-label="AVAR interview mock" style="height:220px;">
            <div class="cap" style="font-size:34px;bottom:48px;">AVAR<br/>Interview</div>
            <div class="time">00 &nbsp; üîä &nbsp; 2:12 / 15:00</div>
            <div class="thumb"></div>
          </div>
        </div>

        <div class="panel" style="margin-top:12px;box-shadow:none;">
          <div class="panelTitle">AI video insights (new)</div>
          <div class="muted tiny">Communication: <b>${t.ai.comms}</b> ‚Ä¢ Role fit: <b>${t.ai.roleFit}</b></div>
          <div class="muted tiny" style="margin-top:8px;">${t.ai.summary}</div>
        </div>

        <div class="acc" id="costAcc">
          <div class="accHead" id="costAccHead">
            <div class="title">Employee Cost</div>
            <div style="display:flex; gap:10px; align-items:center;">
              <div style="font-weight:900;">USD 2,034.9</div>
              <div class="chev">‚åÉ</div>
            </div>
          </div>
          <div class="accBody">
            <table class="costTable">
              <tr><td>Basic Monthly Salary</td><td>1,800.00 USD</td></tr>
              <tr><td class="subRow">Benefit/Insurance <span class="muted">^</span></td><td>630.12 USD</td></tr>
              <tr><td class="subRow indent">Social Security Service (SSS)</td><td class="subRow">144.00 USD</td></tr>
              <tr><td class="subRow indent">PAG-IBIG</td><td class="subRow">21.00 USD</td></tr>
              <tr><td class="subRow indent">PhilHealth</td><td class="subRow">56.00 USD</td></tr>
              <tr><td class="subRow indent">13th Month Pay</td><td class="subRow">150.00 USD</td></tr>
              <tr><td class="subRow indent">Local Holiday Pay</td><td class="subRow">120.00 USD</td></tr>
              <tr><td class="subRow indent">Redundancy Pay Expense</td><td class="subRow">84.12 USD</td></tr>
              <tr><td class="subRow indent">Night Differential</td><td class="subRow">55.00 USD</td></tr>
              <tr><td>Service fee</td><td>399.00 USD</td></tr>
            </table>
          </div>
        </div>

        <div class="panel" id="profileSummaryPanel">
          <div class="panelTitle">Professional Summary</div>
          <ul class="bullets">${t.summary.map(s=>`<li>${s}</li>`).join("")}</ul>
        </div>

        <div class="panel" id="skillHighlightsBottom">
          <div class="panelTitle">Skill Highlights</div>
          <div class="chipRow">
            ${t.skills.slice(0,9).map(s=>`<span class="chip">${s}</span>`).join("")}
            <span class="chip">+${Math.max(0,t.skills.length-9)} skills</span>
          </div>
        </div>

      </div>
    </div>
  `;

  $("saveBtn").onclick = ()=>{
    if(saved.has(t.id)) saved.delete(t.id); else saved.add(t.id);
    toast("Saved", saved.has(t.id) ? "Talent saved." : "Talent removed from saved.");
    renderMarket();
  };

  $("shareBtn").onclick = async ()=>{
    const shareText = `Talent: ${t.name} ‚Ä¢ ${t.role} ‚Ä¢ ${t.cost} ‚Ä¢ ID: ${t.id}`;
    // If browser supports native share (mobile), use it; else copy to clipboard
    try{
      if(navigator.share){
        await navigator.share({ title:"Share Talent", text: shareText });
        toast("Shared", "Shared via your device share sheet.");
        return;
      }
    }catch(e){
      // fall back to clipboard
    }
    try{
      await navigator.clipboard.writeText(shareText);
      toast("Copied", "Talent details copied to clipboard.");
    }catch(e){
      toast("Share", "Copy not available in this browser. (Demo)");
    }
  };

  $("reqInterviewBtn").onclick = ()=> toast("Interview requested", "Request sent. (Demo placeholder)");
  $("viewProfileBtn").onclick = ()=> toast("Profile view", "In a full build, this opens the full profile route.");

  const acc = $("costAcc");
  const head = $("costAccHead");
  if(acc && head){
    acc.classList.remove("open");
    head.onclick = ()=> acc.classList.toggle("open");
  }
}

/* =========================
   Saved
   ========================= */
function renderSaved(){
  const list = $("savedList");
  list.innerHTML = "";
  const items = TALENTS.filter(t=>saved.has(t.id));
  if(items.length===0){
    list.innerHTML = `<div class="card"><div class="cardPad muted">No saved talents yet. Save from a profile on Marketplace.</div></div>`;
    return;
  }
  items.forEach(t=>{
    const el = document.createElement("div");
    el.className = "card talCard";
    el.innerHTML = `
      <div class="talTop">
        <div class="talPic"></div>
        <div style="flex:1">
          <div class="talName">${t.name} <span class="badge">‚úî</span></div>
          <div class="muted tiny">${t.role}</div>
        </div>
        <button class="btn" data-unsave="${t.id}">Remove</button>
      </div>
      <div class="metaRow">
        <div>üü¢ <b>${t.availability}</b></div>
        <div>üí≥ <b>${t.cost}</b></div>
        <div>üìç ${t.city}</div>
        <div>üß† ${t.exp}</div>
      </div>
    `;
    el.querySelector("[data-unsave]").onclick = ()=>{ saved.delete(t.id); renderSaved(); };
    el.onclick = (e)=>{ if(e.target.closest("button")) return; selectedId = t.id; showRoute("market"); };
    list.appendChild(el);
  });
}

/* =========================
   Checkbox dropdown (supports multi + single)
   ========================= */
const msState = new Map();     // id -> Set(values)
const msConfig = new Map();    // id -> { single:boolean }

function buildMultiSelect(containerId, options, placeholderText, cfg={ single:false }){
  const root = $(containerId);
  msConfig.set(containerId, { single: !!cfg.single });
  if(!msState.has(containerId)) msState.set(containerId, new Set());

  root.innerHTML = `
    <div class="msControl" role="button" tabindex="0" aria-haspopup="listbox" aria-expanded="false">
      <div class="ph">${placeholderText}</div>
      <div style="display:flex;gap:10px;align-items:center;min-width:0;">
        <div class="val" style="display:none;"></div>
        <div style="color:#94a3b8;font-weight:900;">‚ñæ</div>
      </div>
    </div>
    <div class="msMenu">
      <input class="msSearch" type="text" placeholder="Search" />
      <div class="msList" role="listbox" aria-multiselectable="true"></div>
    </div>
  `;
  root.classList.add("ms");

  const control = root.querySelector(".msControl");
  const list = root.querySelector(".msList");
  const search = root.querySelector(".msSearch");
  const ph = root.querySelector(".ph");
  const val = root.querySelector(".val");

  function renderList(filter=""){
    list.innerHTML = "";
    const f = filter.trim().toLowerCase();
    options
      .filter(o => !f || o.toLowerCase().includes(f))
      .forEach(opt=>{
        const row = document.createElement("div");
        row.className = "msOpt";
        row.innerHTML = `
          <input type="checkbox" />
          <div style="flex:1;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${opt}</div>
        `;
        const cb = row.querySelector("input");
        cb.checked = msState.get(containerId).has(opt);

        const toggle = ()=>{
          const isSingle = msConfig.get(containerId)?.single;
          if(cb.checked){
            if(isSingle){
              msState.get(containerId).clear();
              list.querySelectorAll("input[type='checkbox']").forEach(x=>x.checked=false);
              cb.checked = true;
            }
            msState.get(containerId).add(opt);
          }else{
            msState.get(containerId).delete(opt);
          }
          syncLabel();
        };

        row.addEventListener("click", (e)=>{
          if(e.target.tagName !== "INPUT"){
            cb.checked = !cb.checked;
          }
          toggle();
        });

        cb.addEventListener("click", (e)=>{
          e.stopPropagation();
          toggle();
        });

        list.appendChild(row);
      });
  }

  function syncLabel(){
    const picked = Array.from(msState.get(containerId));
    if(picked.length === 0){
      ph.style.display = "";
      val.style.display = "none";
      val.textContent = "";
    }else{
      ph.style.display = "none";
      val.style.display = "";
      val.textContent = picked.length === 1 ? picked[0] : `${picked[0]} +${picked.length-1}`;
    }
  }

  function open(){
    root.classList.add("open");
    control.setAttribute("aria-expanded","true");
    renderList(search.value);
    setTimeout(()=>search.focus(), 0);
  }
  function close(){
    root.classList.remove("open");
    control.setAttribute("aria-expanded","false");
  }

  control.addEventListener("click", ()=>{
    root.classList.contains("open") ? close() : open();
  });
  control.addEventListener("keydown", (e)=>{
    if(e.key === "Enter" || e.key === " "){
      e.preventDefault();
      root.classList.contains("open") ? close() : open();
    }
    if(e.key === "Escape"){
      close();
    }
  });

  search.addEventListener("input", ()=> renderList(search.value));
  document.addEventListener("click", (e)=>{
    if(!root.contains(e.target)) close();
  });

  renderList("");
  syncLabel();
}

function msGetSelected(containerId){
  return Array.from(msState.get(containerId) || []);
}
function msClear(containerId){
  msState.set(containerId, new Set());
}

/* =========================
   Onboarding state + logic
   ========================= */
const onboardState = {
  reqDone:false,
  hmDone:false,
  jobReqDone:false,
  priceDone:false,
  invited:[]
};

const BASE_READINESS = 82;
const STEP_POINTS = (100 - BASE_READINESS) / 4;

function setPill(el, done){
  el.classList.toggle("done", !!done);
  el.classList.toggle("pending", !done);
  el.textContent = done ? "Done" : "Pending";
}

function calcReadiness(){
  let done = 0;
  if(onboardState.reqDone) done++;
  if(onboardState.hmDone) done++;
  if(onboardState.jobReqDone) done++;
  if(onboardState.priceDone) done++;
  return Math.round(BASE_READINESS + done * STEP_POINTS);
}

function refreshOnboardingUI(){
  const pct = calcReadiness();
  $("readinessPctPill").textContent = pct + "%";
  $("readinessBar").style.width = pct + "%";

  setPill($("stReq"), onboardState.reqDone);
  setPill($("stHm"), onboardState.hmDone);
  setPill($("stJobReq"), onboardState.jobReqDone);
  setPill($("stPrice"), onboardState.priceDone);

  const allDone = onboardState.reqDone && onboardState.hmDone && onboardState.jobReqDone && onboardState.priceDone;
  $("startHiringBtn").disabled = !allDone;
  $("startHiringHint").textContent = allDone ? "Ready! Click Start hiring to continue to Jobs." : "Complete all pending items to enable Start hiring.";
}

function renderInvites(){
  const box = $("inviteList");
  box.innerHTML = "";
  if(onboardState.invited.length === 0){
    box.innerHTML = `<div class="muted tiny" style="font-weight:900;">No invites sent yet.</div>`;
    return;
  }
  onboardState.invited.slice().reverse().forEach(inv=>{
    const el = document.createElement("div");
    el.className = "statusItem";
    el.innerHTML = `<b>${inv.email} ‚Ä¢ ${inv.dept} ‚Ä¢ ${inv.loc}</b><span class="pillStatus done">Sent</span>`;
    box.appendChild(el);
  });
}

function setHmSelf(isSelf){
  const selfSub = $("hmSelfSub");
  const cert = $("hmCert");

  if(isSelf){
    $("hmName").value = "Tim Vorbach";
    $("hmEmail").value = "tim.vorbach@emapta.com";
    cert.checked = true;
    cert.disabled = true;
    if(selfSub) selfSub.textContent = "Prefilled with your details.";
  }else{
    $("hmName").value = "";
    $("hmEmail").value = "";
    cert.checked = false;
    cert.disabled = false;
    if(selfSub) selfSub.textContent = "If selected, we‚Äôll prefill your details.";
  }
}

function resetOnboarding(){
  $("reqRole").value = "";
  $("reqCount").value = "";
  $("reqStartDate").value = "";
  $("reqStatusText").textContent = "Hiring request details not set.";

  // Hiring manager
  $("hmSelf").checked = false;
  $("hmCert").checked = false;
  $("hmCert").disabled = false;
  $("hmName").value = "";
  $("hmEmail").value = "";

  $("jdFile").value = "";
  $("priceMin").value = "";
  $("priceMax").value = "";
  $("inviteEmail").value = "";

  // reset checkbox dropdown state
  ["techSkillsMS","softSkillsMS","workArrangementMS","workScheduleMS","timeZoneMS"].forEach(id=>{
    msClear(id);
  });

  // rebuild components to ensure labels reflect empty (and keep same UI)
  buildMultiSelect("techSkillsMS", TECH_SKILLS_OPTS, "Search skill (e.g., React JS)");
  buildMultiSelect("softSkillsMS", SOFT_SKILLS_OPTS, "Search skill (e.g., Critical Thinking)");
  buildMultiSelect("workArrangementMS", WORK_ARRANGEMENT_OPTS, "Select work arrangement", { single:true });
  buildMultiSelect("workScheduleMS", WORK_SCHEDULE_OPTS, "Select work schedule", { single:true });
  buildMultiSelect("timeZoneMS", TIME_ZONE_OPTS, "Select time zone", { single:true });

  onboardState.reqDone = false;
  onboardState.hmDone = false;
  onboardState.jobReqDone = false;
  onboardState.priceDone = false;
  onboardState.invited = [];

  $("hmAddedText").textContent = "No hiring manager added yet.";
  $("jdStatusText").textContent = "No JD provided yet.";
  $("jobReqStatusText").textContent = "Job requirements not set.";
  $("priceStatusText").textContent = "Price range not set.";

  renderInvites();
  refreshOnboardingUI();
}

/* =========================
   Wiring
   ========================= */
document.querySelectorAll(".navLinks a").forEach(a=>{
  a.onclick = (e)=>{ e.preventDefault(); showRoute(a.dataset.route); };
});

$("heroSearchBtn").onclick = ()=>{
  const role = $("roleInput").value.trim();
  const loc  = $("locInput").value.trim();
  const exp  = $("expInput").value.trim();
  const sMin = $("salMin").value.trim();
  const sMax = $("salMax").value.trim();
  const days = parseInt($("availDays").value, 10);

  toast("Search",
    `Role: ${role || "‚Äî"} ‚Ä¢ Location: ${loc || "‚Äî"} ‚Ä¢ Exp: ${exp || "‚Äî"} ‚Ä¢ Salary: ${sMin || "‚Äî"}‚Äì${sMax || "‚Äî"} ‚Ä¢ Availability: ${days===0 ? "now" : "‚â§ "+days+" days"}`
  );
  showRoute("market");
};

$("viewMoreBtn").onclick = ()=> showRoute("market");

$("startOnboardingBtn").onclick = ()=>{
  resetOnboarding();
  openOverlay("onboardOverlay");
};
$("goToOnboardingMini").onclick = ()=>{
  resetOnboarding();
  openOverlay("onboardOverlay");
};

document.querySelectorAll("[data-close]").forEach(b=> b.onclick = ()=> closeOverlay(b.dataset.close));

/* Backdrop closes overlay */
document.querySelectorAll(".overlay").forEach(ov=>{
  ov.addEventListener("click", (e)=>{
    if(e.target === ov) closeOverlay(ov.id);
  });
});

/* Esc closes top-most overlay */
document.addEventListener("keydown", (e)=>{
  if(e.key !== "Escape") return;
  const open = Array.from(document.querySelectorAll(".overlay.show"));
  if(open.length) closeOverlay(open[open.length - 1].id);
});

$("menuBtn").onclick = ()=> toast("Menu", "Job requests ‚Ä¢ Saved talents ‚Ä¢ Manage (demo).");

/* Availability label */
function updateAvailLabel(){
  const days = parseInt($("availDays").value, 10);
  $("availLabel").textContent = (days === 0) ? "Available now" : `‚â§ ${days} days`;
}
$("availDays").addEventListener("input", updateAvailLabel);

/* Filters + advanced + semantic */
$("openFiltersBtn").onclick = ()=> openOverlay("filtersOverlay");
$("advancedBtn").onclick = ()=> openOverlay("advancedOverlay");
$("semanticBtn").onclick = ()=> openOverlay("semanticOverlay");

/* Filters interactions */
document.querySelectorAll(".pref").forEach(p=>{
  p.onclick = ()=>{
    document.querySelectorAll(".pref").forEach(x=>x.classList.remove("active"));
    p.classList.add("active");
  };
});
function wireChipRemove(containerId){
  const box = $(containerId);
  box.addEventListener("click", (e)=>{
    const btn = e.target.closest("button[data-x]");
    if(!btn) return;
    const chip = btn.closest(".chipX");
    if(chip) chip.remove();
  });
}
wireChipRemove("techChips");
wireChipRemove("softChips");

function addChip(containerId, value){
  if(!value) return;
  const box = $(containerId);
  const span = document.createElement("span");
  span.className = "chipX";
  span.innerHTML = `${value} <button data-x="${value}">√ó</button>`;
  const input = box.querySelector("input");
  box.insertBefore(span, input);
}
$("techAdd").addEventListener("keydown", (e)=>{
  if(e.key === "Enter"){
    e.preventDefault();
    addChip("techChips", $("techAdd").value.trim());
    $("techAdd").value = "";
  }
});
$("softAdd").addEventListener("keydown", (e)=>{
  if(e.key === "Enter"){
    e.preventDefault();
    addChip("softChips", $("softAdd").value.trim());
    $("softAdd").value = "";
  }
});

document.querySelectorAll(".profBtn").forEach(b=>{
  b.onclick = ()=> b.classList.toggle("active");
});

$("clearFiltersBtn").onclick = ()=>{
  document.querySelectorAll(".pref").forEach(x=>x.classList.remove("active"));
  document.querySelector('.pref[data-pref="wfh"]').classList.add("active");
  $("fMin").value = "100";
  $("fMax").value = "5000";
  document.querySelectorAll("#profRow .profBtn").forEach(x=>x.classList.remove("active"));
  toast("Cleared", "Filters cleared. (Demo)");
};

$("applyFiltersBtn").onclick = ()=>{
  toast("Filters applied", "Results refreshed. (Demo)");
  closeOverlay("filtersOverlay");
};

/* Advanced search */
$("runAdvancedBtn").onclick = ()=>{
  const all = $("advAll").value.trim();
  const any = $("advAny").value.trim();
  const none = $("advNone").value.trim();
  const exact = $("advExact").value.trim();
  toast("Advanced search", `All: ${all||"‚Äî"} ‚Ä¢ Any: ${any||"‚Äî"} ‚Ä¢ None: ${none||"‚Äî"} ‚Ä¢ Exact: ${exact||"‚Äî"}`);
  closeOverlay("advancedOverlay");
};

/* Semantic search */
$("runSemanticBtn").onclick = ()=>{
  const q = $("semanticInput").value.trim();
  if(!q){ toast("Type your request", "Add a short description of what you need."); return; }
  toast("Semantic search", "Intent captured. (Demo) Showing matching talent results.");
  closeOverlay("semanticOverlay");
};

/* Onboarding */
$("resetOnboardBtn").onclick = ()=>{
  resetOnboarding();
  toast("Reset", "Onboarding fields cleared and readiness reset to 82%.");
};

/* Hiring manager self toggle */
$("hmSelf").addEventListener("change", ()=>{
  setHmSelf($("hmSelf").checked);
});

$("saveReqBtn").onclick = ()=>{
  const role = $("reqRole").value.trim();
  const count = $("reqCount").value.trim();
  const sd = $("reqStartDate").value;
  const countNum = Number(count);
  if(!role || !count || Number.isNaN(countNum) || countNum<=0 || !sd){
    toast("Missing info", "Fill role, how many, and start date.");
    onboardState.reqDone = false;
    $("reqStatusText").textContent = "Hiring request details not set.";
    refreshOnboardingUI();
    return;
  }
  onboardState.reqDone = true;
  $("reqStatusText").textContent = `Saved: ${role} ‚Ä¢ ${countNum} headcount ‚Ä¢ Start ${sd}`;
  refreshOnboardingUI();
  toast("Saved", "Hiring request details saved.");
};

$("addHmBtn").onclick = ()=>{
  const isSelf = $("hmSelf").checked;
  const n = $("hmName").value.trim();
  const e = $("hmEmail").value.trim();
  const certOk = !!$("hmCert").checked;

  if(!n || !e || !e.includes("@")){
    toast("Missing info", "Add a hiring manager name and valid email.");
    return;
  }
  if(!isSelf && !certOk){
    toast("Confirm required", "Please confirm the hiring manager is on your team and in your Emapta profile.");
    return;
  }

  onboardState.hmDone = true;
  $("hmAddedText").textContent = `Added: ${n} (${e})`;
  refreshOnboardingUI();
  toast("Hiring manager added", "Checklist updated.");
};

$("jdFile").addEventListener("change", ()=>{
  if($("jdFile").files && $("jdFile").files.length){
    $("jdStatusText").textContent = `JD attached: ${$("jdFile").files[0].name}`;
    toast("JD attached", "Attached. Now save job requirements.");
  }
});

$("saveJobReqBtn").onclick = ()=>{
  const hasJD = $("jdFile").files && $("jdFile").files.length;
  const techOk = msGetSelected("techSkillsMS").length > 0;
  const softOk = msGetSelected("softSkillsMS").length > 0;
  const arrOk = msGetSelected("workArrangementMS").length > 0;
  const schOk = msGetSelected("workScheduleMS").length > 0;
  const tzOk  = msGetSelected("timeZoneMS").length > 0;

  if(!hasJD || !techOk || !softOk || !arrOk || !schOk || !tzOk){
    onboardState.jobReqDone = false;
    $("jobReqStatusText").textContent = "Job requirements not set.";
    refreshOnboardingUI();
    toast("Missing fields", "Attach JD and complete all required job requirement fields.");
    return;
  }

  onboardState.jobReqDone = true;
  $("jobReqStatusText").textContent = "Job requirements saved.";
  refreshOnboardingUI();
  toast("Saved", "Job requirements saved.");
};

$("savePriceBtn").onclick = ()=>{
  const mi = $("priceMin").value.trim();
  const ma = $("priceMax").value.trim();
  const minNum = Number(mi), maxNum = Number(ma);
  if(!mi || !ma || Number.isNaN(minNum) || Number.isNaN(maxNum) || minNum<=0 || maxNum<=0 || minNum>maxNum){
    toast("Invalid range", "Enter a valid min/max monthly USD range.");
    return;
  }
  onboardState.priceDone = true;
  $("priceStatusText").textContent = `Saved: ${minNum.toLocaleString()} ‚Äì ${maxNum.toLocaleString()} USD / month`;
  refreshOnboardingUI();
  toast("Price range saved", "Checklist updated.");
};

$("sendInviteBtn").onclick = ()=>{
  const email = $("inviteEmail").value.trim();
  const dept = $("inviteDept").value;
  const loc = $("inviteLoc").value;
  if(!email || !email.includes("@")){ toast("Invalid email", "Enter a hiring manager email."); return; }
  onboardState.invited.push({email, dept, loc, ts:Date.now()});
  $("inviteEmail").value = "";
  renderInvites();
  toast("Invite sent", `Sent to ${email} (${dept}, ${loc}).`);
};

$("startHiringBtn").onclick = ()=>{
  toast("Start hiring", "Onboarding complete. Returning to Jobs‚Ä¶");
  closeOverlay("onboardOverlay");
  showRoute("market");
};

/* Quick tour actions */
function showTour(type){
  if(type === "video"){
    $("tourTitle").textContent = "2-minute training video";
    $("tourBody").innerHTML = `
      <div class="videoMock" style="height:260px;">
        <div class="cap">ETM<br/>Training</div>
        <div class="time">00 &nbsp; üîä &nbsp; 0:18 / 2:00</div>
        <div class="thumb"></div>
      </div>
      <div class="panel" style="margin-top:0;">
        <div class="panelTitle">What you‚Äôll learn</div>
        <ul class="bullets">
          <li>How readiness reaches 100% (what‚Äôs required vs optional)</li>
          <li>How to attach JD + set skills/schedule/time zone</li>
          <li>How ‚ÄúStart hiring‚Äù unlocks the Jobs workflow</li>
        </ul>
      </div>
    `;
  } else {
    $("tourTitle").textContent = "Do it with me: guided walkthrough";
    $("tourBody").innerHTML = `
      <div class="panel" style="margin-top:0;">
        <div class="panelTitle">Guided checklist</div>
        <ul class="bullets">
          <li><b>Step 1:</b> Fill hiring request (role, count, start date) ‚Üí click ‚ÄúSave hiring request‚Äù</li>
          <li><b>Step 2:</b> Add a hiring manager ‚Üí click ‚ÄúAdd‚Äù</li>
          <li><b>Step 3:</b> Attach JD + pick skills/schedule/time zone ‚Üí click ‚ÄúSave job requirements‚Äù</li>
          <li><b>Step 4:</b> Save your price range ‚Üí click ‚ÄúSave‚Äù</li>
          <li><b>Finish:</b> Click ‚ÄúStart hiring‚Äù when enabled</li>
        </ul>
      </div>
      <div class="panel">
        <div class="panelTitle">Tip</div>
        <div class="muted tiny">If anything looks off, open the ETM AI chatbot in the bottom-right and describe the issue ‚Äî it can capture problems and guide you.</div>
      </div>
    `;
  }
  openOverlay("tourOverlay");
}
$("watch2minBtn").onclick = ()=> showTour("video");
$("doItWithMeBtn").onclick = ()=> showTour("doit");

/* =========================
   ETM AI chatbot (conversational demo)
   ========================= */
const chat = {
  open:false,
  history:[
    { role:"bot", text:"Hi! I‚Äôm ETM AI. Ask anything about the platform, or describe an issue and I‚Äôll help (demo)." }
  ]
};

function renderChat(){
  const body = $("chatBody");
  body.innerHTML = "";
  chat.history.forEach(m=>{
    const div = document.createElement("div");
    div.className = "msg " + (m.role === "user" ? "user" : "bot");
    div.textContent = m.text;
    body.appendChild(div);
  });
  body.scrollTop = body.scrollHeight;
}

function botReply(userText){
  const t = userText.toLowerCase();

  if(t.includes("bug") || t.includes("issue") || t.includes("problem") || t.includes("error") || t.includes("broken")){
    return "Thanks ‚Äî I‚Äôve captured this as a support ticket (demo). Can you share: which page, what you clicked, and what you expected vs what happened?";
  }

  if(t.includes("readiness") || t.includes("100%") || t.includes("start hiring")){
    return "Readiness hits 100% after: (1) hiring request details, (2) hiring manager, (3) job requirements (JD + skills + arrangement + schedule + time zone), and (4) price range. Then ‚ÄúStart hiring‚Äù becomes enabled.";
  }

  if(t.includes("attach") || t.includes("jd")){
    return "To attach a JD: go to Job Requirements ‚Üí click ‚ÄúAttach JD‚Äù. Then choose skills/schedule/time zone and click ‚ÄúSave job requirements‚Äù.";
  }

  if(t.includes("semantic") || t.includes("conversational search") || t.includes("search")){
    return "Use Semantic search to type your request in natural language (e.g., ‚Äòneed an accountant for month-end close, start in 2 weeks‚Äô). Advanced search is keyword-based (all/any/none/exact).";
  }

  return "Got it. In this demo, I can explain workflows, help you find features, or capture issues. What are you trying to do right now?";
}

function sendChat(){
  const txt = $("chatInput").value.trim();
  if(!txt) return;
  chat.history.push({ role:"user", text: txt });
  $("chatInput").value = "";
  renderChat();

  setTimeout(()=>{
    chat.history.push({ role:"bot", text: botReply(txt) });
    renderChat();
  }, 350);
}

$("chatFab").onclick = ()=>{
  chat.open = !chat.open;
  $("chatWin").classList.toggle("show", chat.open);
  if(chat.open){
    renderChat();
    setTimeout(()=> $("chatInput").focus(), 0);
  }
};
$("chatClose").onclick = ()=>{
  chat.open = false;
  $("chatWin").classList.remove("show");
};
$("chatSend").onclick = sendChat;
$("chatInput").addEventListener("keydown", (e)=>{
  if(e.key === "Enter"){
    e.preventDefault();
    sendChat();
  }
});

/* =========================
   Init
   ========================= */
const TECH_SKILLS_OPTS = [
  "AWS (Amazon Web Services)",
  "Docker",
  "Elasticsearch",
  "GitLab CI/CD",
  "Jenkins",
  "CircleCI",
  "Travis CI",
  "Bamboo",
  "GitHub Actions",
  "TeamCity",
  "Postgres",
  "Node.js",
  "React"
];
const SOFT_SKILLS_OPTS = [
  "Accountability",
  "Accuracy",
  "Accuracy And Precision",
  "Active Listening",
  "Adaptability",
  "Conflict Resolution",
  "Critical Thinking",
  "Teamwork",
  "Communication"
];

const WORK_ARRANGEMENT_OPTS = ["Work From Home","Onsite","Hybrid"];
const WORK_SCHEDULE_OPTS = ["Morning shift","Midshift","Night shift","Flexible shift"];
const TIME_ZONE_OPTS = [
  "America/Los_Angeles (UTC -08:00)",
  "America/Denver (UTC -07:00)",
  "America/Winnipeg (UTC -06:00)",
  "America/Toronto (UTC -05:00)",
  "America/Bogota (UTC -05:00)",
  "Europe/London (UTC +00:00)",
  "Europe/Berlin (UTC +01:00)",
  "Asia/Manila (UTC +08:00)"
];

// build dropdowns
buildMultiSelect("techSkillsMS", TECH_SKILLS_OPTS, "Search skill (e.g., React JS)");
buildMultiSelect("softSkillsMS", SOFT_SKILLS_OPTS, "Search skill (e.g., Critical Thinking)");
buildMultiSelect("workArrangementMS", WORK_ARRANGEMENT_OPTS, "Select work arrangement", { single:true });
buildMultiSelect("workScheduleMS", WORK_SCHEDULE_OPTS, "Select work schedule", { single:true });
buildMultiSelect("timeZoneMS", TIME_ZONE_OPTS, "Select time zone", { single:true });

renderHandpicked();
updateAvailLabel();
resetOnboarding();
showRoute("landing");

// initial chat render (keeps state across pages)
renderChat();
</script>
</body>
</html>
